<tbody>
{% for row in data %}
  {% if not group or group|length_is:"0" %}
    <tr>
  {% else %}
    <tr class="group">
  {% endif %}
  {% for field in fields %}
    {% if group and field in group %}
      {% if row|get_item:'rowspan' != 0 %}
        <td rowspan="{{ row|get_item:'rowspan' }}" style="
          {% with field|add:'|STYLE' as field_style %}
            {% if row|get_item:field_style %}
              {{ row|get_item:field_style }}
            {% endif %}
          {% endwith %}
          {% if style %}
            {% if style|get_item:forloop.counter %}
              {{ style|get_item:forloop.counter }}
            {% endif %}
          {% endif %}
        ">
          {% with field|add:'|HOVER' as field_hover %}
            {% if row|get_item:field_hover %}
              <span title="{{ row|get_item:field_hover }}">
            {% endif %}
          {% endwith %}

          {% if field in safe %}
            {{ row|get_item:field|safe }}
          {% else %}
            {% include "layout/html_tbody_fieldlink.html" with row=row field=field only %}
          {% endif %}

          {% with field|add:'|HOVER' as field_hover %}
            {% if row|get_item:field_hover %}
              </span>
            {% endif %}
          {% endwith %}
        </td>
      {% endif %}
    {% else %}
      <td style="
        {% with field|add:'|STYLE' as field_style %}
          {% if row|get_item:field_style %}
            {{ row|get_item:field_style }}
          {% endif %}
        {% endwith %}
        {% if style %}
          {% if style|get_item:forloop.counter %}
            {{ style|get_item:forloop.counter }}
          {% endif %}
        {% endif %}
      ">
        {% with field|add:'|HOVER' as field_hover %}
          {% if row|get_item:field_hover %}
            <span title="{{ row|get_item:field_hover }}">
          {% endif %}
        {% endwith %}

        {% if field in safe %}
          {{ row|get_item:field|safe }}
        {% else %}
          {% include "layout/html_tbody_fieldlink.html" with row=row field=field only %}
        {% endif %}

        {% with field|add:'|HOVER' as field_hover %}
          {% if row|get_item:field_hover %}
            </span>
          {% endif %}
        {% endwith %}
      </td>
    {% endif %}
  {% endfor %}
  </tr>
{% endfor %}
</tbody>
