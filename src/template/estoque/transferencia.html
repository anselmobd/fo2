{% extends 'estoque/index.html' %}

{% block title.content %}{{ titulo }} - {{ block.super }}{% endblock title.content %}
{% block header.content %}{{ titulo }} - <a href="{% url 'estoque:index' %}">{{ block.super }}</a>{% endblock header.content %}

{% block stylesheet %}
<style>
{% include 'layout/simple_table.css' %}
.qtd_old {
  {% if request.POST.executa and not erro %}
    color: darkgray;
    font-style: italic;
  {% else %}
    color: darkblue;
    font-weight: bold;
  {% endif %}
}
.qtd_new {
  {% if request.POST.executa and not erro %}
    color: darkblue;
    font-weight: bold;
  {% else %}
    color: darkgray;
    font-style: italic;
  {% endif %}
}
.qtd_atual {
  color: darkblue;
  font-weight: bold;
}
.arrow {
  color: darkgray;
}
.ok {
  color: darkgreen;
}
.bad {
  color: darkred;
}
</style>
{% endblock %}

{% block content %}
<form action="{% url 'estoque:transferencia' %}" method="post">
  {% csrf_token %}
  {{ form.as_p }}
  <input type="submit" name="analisa" value="Analisa"/>
  {% if request.POST.analisa or request.POST.executa %}
    <a class="btn btn-primary" href="{% url 'estoque:transferencia' %}">Limpa</a>
  {% endif %}
  {% if erro %}
    <h4 class="bad">Erro: {{ erro }}</h4>
  {% endif %}
  {% if sucesso %}
    <h4 class="ok">Sucesso: {{ sucesso }}</h4>
  {% endif %}
  {% if request.POST.analisa or request.POST.executa %}
    {% include "layout/form_inputs_report.html" with form=form h=5 only %}
    {% if request.POST.analisa or erro %}
      <h4>Movimentações a fazer.</h4>
    {% else %}
      <h4>Movimentações feitas!</h4>
    {% endif %}
    <h4>Estoque no depósito de origem: <span class='qtd_old'>{{ estoque_origem }}</span> <span class='arrow'>&rarr;</span> <span class='qtd_new'>{{ novo_estoque_origem }}</span></h4>
    <h4>Estoque no depósito de destino: <span class='qtd_old'>{{ estoque_destino }}</span> <span class='arrow'>&rarr;</span> <span class='qtd_new'>{{ novo_estoque_destino }}</span></h4>
    <h4><span class='qtd_atual'>(Quantidade atual)</span></h4>
  {% endif %}
  {% if request.POST.analisa and not erro %}
    <input class="btn btn-primary" type="submit" name="executa" value="Executa"/>
  {% endif %}
</form>
{% endblock %}
